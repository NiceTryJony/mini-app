<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Manager</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1 data-translate="appTitle">–ú–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–≤–¥–∞–Ω—å</h1>
            <div class="user-info">
                <div class="user-avatar" id="userAvatar">U</div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-tabs">
            <button class="nav-tab active" data-view="tasks" onclick="switchView('tasks')">
                <span data-translate="navTasks">–ó–∞–≤–¥–∞–Ω–Ω—è</span>
            </button>
            <button class="nav-tab" data-view="archive" onclick="switchView('archive')">
                <span data-translate="navArchive">–ê—Ä—Ö—ñ–≤</span>
            </button>
            <button class="nav-tab" data-view="settings" onclick="switchView('settings')">
                <span data-translate="navSettings">–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</span>
            </button>
        </div>

        <!-- Tasks View -->
        <div id="tasksView" class="view">
            <button class="create-btn" onclick="openCreateModal()">
                <span data-translate="createTask">+ –°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è</span>
            </button>

            <!-- Search Section -->
            <div class="search-section">
                <div class="search-title" data-translate="searchByDate">–ü–æ—à—É–∫ –∑–∞ –¥–∞—Ç–æ—é</div>
                <div class="search-inputs">
                    <div class="form-group">
                        <label data-translate="dateFrom">–í—ñ–¥</label>
                        <input type="date" id="searchDateFrom">
                    </div>
                    <div class="form-group">
                        <label data-translate="dateTo">–î–æ</label>
                        <input type="date" id="searchDateTo">
                    </div>
                </div>
                <div class="search-actions">
                    <button class="btn btn-primary" onclick="searchTasks()">
                        <span data-translate="search">–®—É–∫–∞—Ç–∏</span>
                    </button>
                    <button class="btn btn-secondary" onclick="resetSearch()">
                        <span data-translate="resetSearch">–°–∫–∏–Ω—É—Ç–∏</span>
                    </button>
                </div>
            </div>

            <div id="tasksContainer">
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <div data-translate="loading">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>
                </div>
            </div>
        </div>

        <!-- Archive View -->
        <div id="archiveView" class="view" style="display: none;">
            <div id="archiveContainer"></div>
        </div>

        <!-- Settings View -->
        <div id="settingsView" class="view" style="display: none;">
            <div class="task-card">
                <h3 data-translate="language">–ú–æ–≤–∞</h3>
                <p>–ü–æ—Ç–æ—á–Ω–∞: <strong id="currentLangText">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</strong></p>
                <button class="btn btn-primary" onclick="changeLanguage()">
                    –ó–º—ñ–Ω–∏—Ç–∏ –Ω–∞ English / Change to –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞
                </button>
            </div>

            <div class="task-card">
                <h3 data-translate="timezone">–ß–∞—Å–æ–≤–∏–π –ø–æ—è—Å</h3>
                <p id="timezoneInfo"></p>
            </div>

            <div class="task-card">
                <h3>–ü—Ä–æ –¥–æ–¥–∞—Ç–æ–∫</h3>
                <p>Task Manager v2.0</p>
                <p>–ú–µ–Ω–µ–¥–∂–µ—Ä –∑–∞–≤–¥–∞–Ω—å –¥–ª—è –∫–æ–º–∞–Ω–¥–∏ –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é —É–≤–µ–¥–æ–º–ª–µ–Ω—å, —á–µ–∫-–ª–∏—Å—Ç—ñ–≤ —Ç–∞ —Ñ–æ—Ç–æ.</p>
            </div>
        </div>
    </div>

    <!-- Task Modal -->
    <div id="taskModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="taskModalTitle" data-translate="newTask">–ù–æ–≤–µ –∑–∞–≤–¥–∞–Ω–Ω—è</h2>
                <button class="close-btn" onclick="closeModal('taskModal')">&times;</button>
            </div>

            <form id="taskForm" onsubmit="saveTask(event)">
                <input type="hidden" id="taskId">

                <div class="form-group">
                    <label data-translate="title">–ù–∞–∑–≤–∞ *</label>
                    <input type="text" id="taskTitle" name="title" 
                           data-translate-placeholder="titlePlaceholder" 
                           placeholder="–ù–∞–∑–≤–∞ –∑–∞–≤–¥–∞–Ω–Ω—è" required>
                </div>

                <div class="form-group">
                    <label data-translate="description">–û–ø–∏—Å</label>
                    <textarea id="taskDescription" name="description" 
                              data-translate-placeholder="descriptionPlaceholder"
                              placeholder="–û–ø–∏—Å –∑–∞–≤–¥–∞–Ω–Ω—è (–Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ)"></textarea>
                </div>

                <div class="form-group">
                    <label data-translate="preparationDate">–î–∞—Ç–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏ *</label>
                    <input type="datetime-local" id="taskPrepDate" name="preparation_date" required>
                </div>

                <div class="form-group">
                    <label data-translate="eventDate">–î–∞—Ç–∞ –ø–æ–¥—ñ—ó *</label>
                    <input type="datetime-local" id="taskEventDate" name="event_date" required>
                </div>

                <div class="form-group">
                    <label data-translate="photos">–§–æ—Ç–æ–≥—Ä–∞—Ñ—ñ—ó</label>
                    <div class="file-input-wrapper">
                        <input type="file" id="photoInput" accept="image/*" onchange="uploadPhoto()">
                        <label for="photoInput" class="file-input-label">
                            <span data-translate="addPhoto">üì∑ –î–æ–¥–∞—Ç–∏ —Ñ–æ—Ç–æ</span>
                        </label>
                    </div>
                    <div id="photoPreview" class="photo-preview"></div>
                </div>

                <div class="form-group">
                    <button type="button" id="checklistToggleBtn" class="btn btn-secondary" 
                            onclick="toggleChecklistSection()">
                        ‚ñ∂ <span data-translate="showChecklist">–ü–æ–∫–∞–∑–∞—Ç–∏ —á–µ–∫-–ª–∏—Å—Ç</span>
                    </button>
                </div>

                <div id="checklistSection" style="display: none;">
                    <div class="form-group">
                        <label data-translate="checklist">–ß–µ–∫-–ª–∏—Å—Ç</label>
                        <div class="checklist-form">
                            <div class="checklist-input-group">
                                <input type="text" id="checklistItemInput" 
                                       placeholder="–ù–æ–≤–∏–π –ø—É–Ω–∫—Ç —á–µ–∫-–ª–∏—Å—Ç—É">
                                <button type="button" class="btn btn-primary" 
                                        onclick="addChecklistItemToForm()">+</button>
                            </div>
                        </div>
                        <div id="checklistPreview" class="checklist-items" style="margin-top: 12px;"></div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('taskModal')">
                        <span data-translate="cancel">–°–∫–∞—Å—É–≤–∞—Ç–∏</span>
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <span data-translate="save">–ó–±–µ—Ä–µ–≥—Ç–∏</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Photo Viewer -->
    <div id="photoViewer" class="photo-viewer">
        <button class="photo-viewer-close" onclick="closePhotoViewer()">&times;</button>
        <img id="viewerImage" src="" alt="Photo">
    </div>

    <!-- Global Loader -->
    <div id="globalLoader" class="global-loader">
        <div class="loader-content">
            <div class="loader-spinner"></div>
            <div class="loader-text" id="loaderText">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>
        </div>
    </div>

    <script src="locales.js"></script>
    <script src="app.js"></script>
</body>
</html>